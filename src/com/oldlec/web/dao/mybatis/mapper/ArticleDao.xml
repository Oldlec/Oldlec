<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper    
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"    
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
   
<mapper namespace = "com.oldlec.web.dao.ArticleDao"> 

<!--    	public List<Article> getArticles(int page, String column, String keyword);

	
	public Article getArticle(int no);
	public int getTotal();
	public int writeArticle(Article newArticle);
	 -->
   	
   		
	<select id="getArticles" parameterType="hashmap" resultType = "com.oldlec.web.vo.Article">
		SELECT *
		FROM (
			SELECT
			ROW_NUMBER ( )  OVER (order by No ) AS RowNum,
			ArticleView.* 
			from ArticleView
		) AS Marked
		WHERE 
			${param2} LIKE '%${param3}%' AND
			RowNum BETWEEN  1 + (#{param1,jdbcType=NUMERIC}-1)*10 
							AND 10 * #{param1,jdbcType=NUMERIC}
	</select>
	   
	<select id="getArticle" resultType = "com.oldlec.web.vo.Article">
		SELECT * FROM ArticleView WHERE No = #{no,jdbcType=NUMERIC}
	</select>
 
 	<select id="getTotal" resultType = "int">
 		<![CDATA[
 			SELECT rows FROM sysindexes WHERE indid<2 AND id=object_id('[Articles]')
 		]]>
 	</select>
 	
 	<insert id="writeArticle" parameterType="com.oldlec.web.vo.Article">
 		INSERT INTO Articles(
			No,
			CategoryNo,
			UserNo,
			Title,
			Content
		)
		VALUES(
			${no},
			${categoryNo},
			#{userNo},
			#{title},
			#{content}
		);
 			
 	</insert>
 	
 
</mapper>
